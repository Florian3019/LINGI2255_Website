<template name="poolList">

<form class="table form-inline" role="form">
  <div class="form-group">
	  <label for="Year">Année</label>
	  <select class="form-control Year" id="Year">
      <option value="" disabled="" selected="" hidden></option>
		  <option value="2015"> 2015 </option>
	  </select>
	  
    <label for="PoolCategory">Catégorie</label>
    <select class="form-control PoolCategory" id="PoolCategory">
      <option value="" disabled="" selected="" hidden></option>
      <option value="preminimes">Pré Minimes</option>
      <option value="minimes">Minimes</option>
      <option value="cadets">Cadet</option>
      <option value="scolars">Scolaire</option>
      <option value="juniors">Junior</option>
      <option value="seniors">Seniors</option>
      <option value="elites">Elites</option>
    </select>

    <label for="PoolType">Type</label>
    <select class="form-control PoolType" id="PoolType">
      <option value="" disabled="" selected="" hidden></option>
      <option value="men">Homme</option>
      <option value="women">Femme</option>
      <option value="mixed">Mixte</option>
	  <option value="family">Tournoi des familles</option>
    </select>
  </div>
</form>

<table id='poolTable' class='table'>

  {{#with getYear}} <!-- Returns a yearData -->
  {{resetDrake}} <!-- Resets the draggable objects, so that we can move the ones that are created -->    
      {{#with getType this}}
          {{#each getPools this}} <!-- Returns a list of poolData -->
            {{>poolContainerTemplate POOL=this}}
          <!-- {{makeDraggable _id}} -->
          {{/each}}
    {{/with}}
  {{/with}}


</table>

<button type="button" id="save" class="btn btn-default btn-lg">
  <span class="glyphicon glyphicon-star" aria-hidden="true"></span> Save
</button>

<button type="button" id="addPool" class="btn btn-default btn-lg">
  <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Pool
</button>

</template>

<!-- Takes 1 argument : the pool -->
<template name="poolContainerTemplate">
        <td>
          <div class='parent'>
            <h3>
              <label class='label label-primary' for='hy'>Pool</label> <!-- TODO : set the pool name to the court address -->
            </h3>
            <div class='wrapper'>
              <div class='poolContainer' id='{{POOL._id}}'> <!-- _id is here the id of the pool -->
                {{#each POOL.pairs}} <!-- For each pair id in the pool -->
                  {{>poolItem PAIRID=this POOLID=../POOL._id}} <!-- Set ID to the id of the pool, so that we can make it draggable -->
                {{/each}}
              </div>
            </div>
          </div>
        </td>
</template>

<!-- 
  Takes 2 arguments :
  - PAIRID : the id of this pair
  - POOLID : the id of the pool of this pair 
-->
<template name="poolItem">
  {{#with getPair PAIRID}} <!-- get the pair data using its id -->
    <div id="{{this._id}}" class="Pairs" data-startingPoolId="{{../POOLID}}">
      <a href="#" data-toggle="tooltip" title=
      "P1W: {{this.player1.wish}}
      P2W:{{this.player2.wish}}">
        <ul class="list-group">
          {{#with getPlayer this.player1._id}}
            <li class="list-group-item" id="{{this.player1._id}}">{{profile.firstName}} {{profile.lastName}}</li>
          {{/with}}
          {{#with getPlayer this.player2._id}}
            <li class="list-group-item" id="{{this.player2._id}}">{{profile.firstName}} {{profile.lastName}}</li>
          {{/with}}
        </ul>
      </a>
    </div>
  {{/with}}
</template>